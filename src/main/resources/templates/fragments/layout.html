<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<th:block th:fragment="layout (title, content)">

    <head>
        <title th:text="${title}">Todo Web App</title>
        <th:block th:replace="~{fragments/header :: header}"></th:block>
    </head>

    <body class="bg-background-dark min-h-screen flex text-text-light font-sans">

    <div class="w-64 bg-card-dark p-6 flex flex-col justify-between shadow-xl">
        <div>
            <div class="text-2xl font-bold mb-10 text-primary-green">
                Todo Web App
            </div>

            <nav class="space-y-3">
                <a href="/todos" class="flex items-center p-3 rounded-xl transition duration-200"
                   th:classappend="${#httpServletRequest?.requestURI?.startsWith('/todos')} ? 'bg-background-dark text-white' : 'hover:bg-background-dark text-text-secondary'">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></svg>
                    <span class="font-medium">My Tasks</span>
                </a>
                <a href="/shared" class="flex items-center p-3 rounded-xl hover:bg-background-dark text-text-secondary transition duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    <span class="font-medium">Shared Tasks</span>
                </a>
                <a href="/all" class="flex items-center p-3 rounded-xl hover:bg-background-dark text-text-secondary transition duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                    <span class="font-medium">All Tasks</span>
                </a>
                <a href="/settings" class="flex items-center p-3 rounded-xl hover:bg-background-dark text-text-secondary transition duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44C11.4 2 11 2.4 11 2.92l-.63 3.43c-.47.24-.91.53-1.31.86a2.27 2.27 0 0 0-.74.6L5.68 8.1l-.81-.66A2.27 2.27 0 0 0 4.2 7.15L2.3 8.35c-.49.33-.8.88-.69 1.48l.49 2.82c-.32.42-.56.88-.72 1.36a2.27 2.27 0 0 0-.15.78l-.34 1.83c-.09.5.15 1.02.58 1.28l1.49.88c.27.16.5.34.71.55l.86.86a2.27 2.27 0 0 0 .6.74l3.43.63c.52.09.92.53.92 1.05v.44c0 .52-.4.96-.92 1.05l-3.43.63a2.27 2.27 0 0 0-.6.74l-.86.86a2.27 2.27 0 0 0-.71.55l-1.49.88c-.43-.26-.67-.78-.58 1.28l.34 1.83c.09.5.4.85.89 1.15l.66.49c.47.24.91.53 1.31.86a2.27 2.27 0 0 0 .74.6l3.43.63c.52.09.92.53.92 1.05v.44c0 .52.4.96.92 1.05l.63-3.43a2.27 2.27 0 0 0-.6-.74l-.86-.86a2.27 2.27 0 0 0-.71-.55l-1.49-.88c-.43-.26-.67-.78-.58-1.28l.34-1.83c.09-.5.4-.85.89-1.15l.66-.49c.47-.24.91.53 1.31-.86a2.27 2.27 0 0 0 .74-.6l3.43-.63c.52-.09.92-.53.92-1.05V9.44c0-.52-.4-.96-.92-1.05l-.63-3.43a2.27 2.27 0 0 0-.74-.6l-.86-.86a2.27 2.27 0 0 0-.71-.55l-1.49-.88c-.43-.26-.67-.78-.58-1.28l.34-1.83c.09-.5.4-.85.89-1.15l.66-.49c.47-.24.91.53 1.31-.86a2.27 2.27 0 0 0 .74-.6l3.43-.63c.52-.09.92-.53.92-1.05V2.92zM12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
                    <span class="font-medium">Settings</span>
                </a>
            </nav>
        </div>

        <div th:if="${loggedIn}" class="mt-8">
            <a th:href="@{/logout}" class="flex items-center p-3 rounded-xl hover:bg-background-dark text-red-400 transition duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                <span class="font-medium">Logout</span>
            </a>
        </div>
        <div th:if="${!loggedIn}" class="mt-8 space-y-3">
            <a th:href="@{/login}" class="block text-center p-2 rounded-lg bg-blue-600 hover:bg-blue-700 font-medium transition">Login</a>
            <a th:href="@{/register}" class="block text-center p-2 rounded-lg border border-gray-600 hover:bg-card-dark font-medium transition">Register</a>
        </div>

    </div>

    <div class="flex-1 overflow-y-auto p-8">
        <th:block th:replace="~{fragments/navbar :: navbar}"></th:block>

        <main class="mt-8">
            <th:block th:replace="${content}"></th:block>
        </main>
    </div>

    </body>

</th:block>

</html>